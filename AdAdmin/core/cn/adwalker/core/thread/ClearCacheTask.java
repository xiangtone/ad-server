package cn.adwalker.core.thread;import org.codehaus.jackson.map.ObjectMapper;import org.springframework.context.ApplicationContext;import cn.adwalker.core.spring.AppContext;import cn.adwalker.core.util.HttpClientUtil;import cn.adwalker.core.util.JacksonMapper;import cn.adwalker.core.vo.ClearCacheResult;import cn.adwalker.model.log.dao.IClearCacheLogDao;import cn.adwalker.model.log.domain.ClearCacheLog;/** *  * <p> * Title: ClearCacheTask * </p> * <p> * Description:TODO * </p> * <p> * Company: adwalker * </p> *  * @author cuidd * @date 2013-8-2 */public class ClearCacheTask implements Runnable {	private String url;	public ClearCacheTask(String url) {		this.url = url;	}	public void run() {		try {			Thread.sleep(10000);		} catch (InterruptedException e) {			e.printStackTrace();		}		ClearCacheResult resultObj = null;		try {			String s = HttpClientUtil.sendGet(url);			ObjectMapper mapper = JacksonMapper.getInstance();			resultObj = mapper.readValue(s, ClearCacheResult.class);		} catch (Exception e) {			e.printStackTrace();		}		try {			if (resultObj == null || !resultObj.getSuccess().equals("true")) {				ApplicationContext ctx = AppContext.getApplicationContext();				IClearCacheLogDao dao = (IClearCacheLogDao) ctx						.getBean(IClearCacheLogDao.class);				ClearCacheLog log = new ClearCacheLog();				log.setUrl(url);				log.setStatus(0);				log.setCreate_time(new java.util.Date());				dao.insert(log);			}		} catch (Exception e) {			e.printStackTrace();		}	}}